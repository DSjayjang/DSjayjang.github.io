---
layout: single
title: "ANOVA (분산분석)"
categories: Statistics
tag: [statistics, anova]
toc: true # 목차 보여주기
author_profile: false   # 프로필 제거
# sidebar:    # 프로필 제거 후 사이드바 보여주기
#     nav: "counts"
typora-root-url: ../
---
<br><br>

# ※ ANOVA (분산분석)
- Analysis of Variance
- 셋 이상의 모집단 간의 평균을 비교하는데 사용
- 관측한 자료들이 다양하게 나타나는 것을 체계적으로 설명하려는 하나의 통계 기법<br>
→ 관측값들이 달라지는 것을 여러 요인으로 나누어 각 요인들이 얼마나 변화에 기여하였는가를 분석하는 것

<br>

## ■ One-Way ANOVA (일원배치 분산분석)
- 여러 집단의 모평균을 비교하기 위해 전체의 변동을 두가지 요인(**1. 모집단 간의 변동** 과 **2. 모집단 내의 변동**)으로만 나누어 분석하는 방법
- k개의 처리가 있는 일원배치의 자료 구조

| **-**    | **관측 자료** | **평균** | **제곱합** |
|:--------:|:---------:|:------:|:-------:|
| **처리1**  | $y_{11}$,$y_{12}$, ..., $y_{1n}$         | $\bar y_{1}$      | $\sum_{j=1}^{n_{1}}(y_{1j}-\bar y_{1}^2)$       |
| **처리2**  | $y_{21}$,$y_{22}$, ..., $y_{2n}$         | $\bar y_{2}$         | $\sum_{j=1}^{n_{2}}(y_{2j}-\bar y_{2}^2)$       |
| **…**    | …         | …      | …       |
| **처리 k** | $y_{k1}$,$y_{k2}$, ..., $y_{kn}$         | $\bar y_{k}$         | $\sum_{j=1}^{n_{k}}(y_{kj}-\bar y_{k}^2)$       |

#### ● 총 평균 $\bar y$ <br>
  = $\cfrac{\text{관측값들의 총 합계}}{총 자료의 수}$<br>
  = $\cfrac{n_1\bar y_{1}+n_2\bar y_{2}+ ... + n_k\bar y_{k}}{n_{1}+n_{2}+ ... + n_{k}}$<br>

#### ● **$y_{ij} - \bar y$**
- 개개의 관측값의 총평균에 대한 편차

#### ● **$y_{i\cdot} - \bar y$**
- 각 처리간의 평균값의 차이에서 기인하는 부분

#### ● **$y_{ij} - \bar y_{i\cdot}$**
- ***잔차(랜덤오차)***
- 동일한 처리 내에서 발생하는 측정값의 오차에 의한 부분
- 각 관측값과 그 관측값이 속한 처리평균과의 편차

<br>

#### ● **SStr (Treatment Sum of Squares)**
- ***처리제곱합***
- 전체 처리효과들의 변동을 측정하는 양으로, 이 행렬의 원소들의 제곱합
- $\sum_{i=1}^{k} n_{i}(\bar y_{i\cdot}-\bar y)^2$

#### ● **SSE (Error Sum of Squares)**
- ***잔차제곱합***
- 잔차(랜덤오차)들의 제곱합
- $\sum_{i}^{k} \sum_{j}^{n_{i}} (y_{ij}-\bar y_{i\cdot})^2$

#### ● **SST (Total Sum of Squares)**
- ***전체제곱합***
- 개개의 관측값들과 총평균과의 편차들의 제곱합
- $\sum_{i}^{k} \sum_{j}^{n_{i}} (y_{ij}-\bar y)^2$

#### **∴ SST = SStr + SSE**

<br>
<br>

#### ● **제곱합의 자유도 = (제곱을 하여 더하는 항의 수) - (각 항들에 의하여 만족되는 선형제약 조건의 수)**

#### ● **SStr의 자유도**
= $k-1$<br>
↔ $-1$ 이유 : 가중평균 $\bar y = \cfrac{n_{1}\bar y_{1} + ... + n_{k}\bar y_{k}}{n_{1} + ... + n_{k}}$ 라는 선형제약조건

#### ● **SSE의 자유도**
= $(n_{1} + n_{2} + ... + n_{k}) - k$<br>
↔ $-k$ 이유 : $\sum_{j}^{n_{i}} (y_{ij}-\bar y_{i\cdot}) = 0$ → 행의 수 $k$개의 선형제약조건

#### ● **SST의 자유도**
= $n_{1} + n_{1} + ... + n_{k} - 1$<br>
↔ $-1$ 이유 : $\sum_{i}^{k} \sum_{j}^{n_{i}} (y_{ij}-\bar y)^2 = 0$이라는 선형제약조건

#### **∴ SST의 자유도 = SStr의 자유도 + SSE의 자유도**
- $\sum_{i=1}^{k} n_{i} - 1 = (k - 1) + (\sum_{i=1}^{k} n_{i} -k$)

<br>

## ■ 분산분석표

| **요인**    | **제곱합** | **자유도** | **평균제곱** |
|:--------:|:---------:|:------:|:-------:|
| **처리**  | $SStr = \sum_{i=1}^{k} n_{i}(\bar y_{i\cdot}-\bar y)^2$         | $k-1$      | $MStr = \cfrac{SStr}{k-1}$       |
| **오차**  | $SSE = \sum_{i}^{k} \sum_{j}^{n_{i}} (y_{ij}-\bar y_{i})^2$         | $\sum_{i=1}^{k} n_{i}-k$         | $MSE = \cfrac{SSE}{\sum_{i=1}^{k} n_{i}-k}$       |
| **합계**    | $\sum_{i}^{k} \sum_{j}^{n_{i}} (y_{ij}-\bar y)^2$         | $\sum_{i=1}^{k} n_{i}-1$      |        |

## ■ 제곱합의 간편 계산식
$$
T_{i} = \sum_{j=1}^{n_{i}} y_{ij} = \text{처리 $i$에서의 모든 관측값의 합계}
$$
$$
T = \sum_{i=1}^{k} T_{i} = \sum_{i}^{k} \sum_{j}^{n_{i}} y_{ij} = \text{모든 관측값의 총계}
$$
$$
SST = \sum_{i}^{k} \sum_{j}^{n_{i}} y_{ij}^2 - \cfrac{T^2}{n}
$$
$$
SStr = \sum_{i=1}^{k} \cfrac{T_{i}^2}{n_{i}} - \cfrac{T^2}{n} \quad ,(n=\sum_{i=1}^{k} n_{i})
$$
$$
SSE = \sum_{i}^{k} \sum_{j}^{n_{i}} y_{ij}^2 - \sum_{i=1}^{k} \cfrac{T_{i}^2}{n_{i}} \\
= SST - SStr
$$
